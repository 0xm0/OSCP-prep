# Summary
~~~
Redirects are a useful function to have when building a website. If a user attempts to access 
a resource before they are logged in, it is conventional to redirect them to the login page, 
put the original URL in a query parameter, and after they have logged in, automatically redirect 
them to their original destination. This type of functionality shows you are putting thought into 
the user experience, and is to be encouraged. However, you need to be sure anywhere you do redirects, 
they are done safely – otherwise you are putting your users in harm’s way by enabling phishing attacks.
~~~

It also could be possible to inject JavaScript code, for example by submitting the following query string:
~~~~~~~~
http://www.victim.site/?#javascript:alert(document.cookie)
~~~~~~~~
When trying to check for this kind of issues, consider that some characters are treated differently by different browsers.

Moreover always consider the possibility to try absolute URLs variants as described here: http://kotowicz.net/absolute/


# Tools

    DOMinator - https://dominator.mindedsecurity.com/

# Mitigation steps & Examples 

Disallow Offsite Redirects
~~~ 
You can prevent redirects to other domains by checking the URL being passed to the redirect function. 
Make sure all redirect URLs are relative paths – i.e. they start with a single / character. (Note that URLs starting with // will be interpreted by the browser as a protocol agnostic, absolute URL – so they should be rejected too.)

If you do need to perform external redirects, consider whitelisting the individual sites that you permit redirects to.
~~~ 

Check the Referrer When Doing Redirects
~~~
Redirects to URLs passed in query parameters should only be triggered by pages on your site. Any other sites triggering a redirect should be treated with extreme suspicion. As a second layer of defense, check that the Referer in the HTTP request matches your domain whenever you perform a redirect.
~~~
