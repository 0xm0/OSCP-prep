 File Inclusion Vulnerability ( Local & Remote)
==============================================================================

File Inclusion: Some scripting languages ( like PHP) support the use of Include functions ( include() in PHP). The content of included file is interpreted as if the code was actually copied and pasted.

Remote File Inclusion Vulnerability

PHP's include function accepts REMOTE file path, and thus is a basis of numerous vulnerabilities.
Vulnerability exists when >> User controllable input is used to specify the INCLUDE file name.
Attacker can specify an external URL pointing to a malicious script as the location of the include file.

    www.example.com/index.php?Country=US

The corresponding backend PHP code is

    $country =$_GET['Country']include ( $country. '.php' );

The contents of  US.php are effectively copied in index.php and then are executed.

Local File Inclusion Vulnerability

When the include function of any language allows local (or only local -Eg. Server.Execute() in ASP) files to be included, and the application accepts User controllable data as input to the Include function then the attacker may be able to specify a local file ( Eg. /Admin.aspx) and have it included in the page.

Attacking File Inclusion Vulnerabilities

    Commonly found in request parameters which specify Language or Location
    Found in parameters which specify a server file name.

To Detect a remote file inclusion vulnerability

    Find the Parameter to be tested & Specify the URL to a server you control and see if your server gets any requests from the vulnerable application

To Detect a local file inclusion vulnerability

    Wider range of scripting environments allow Local File inclusion compared to remote file inclusion
    Submit the name of a known executable or static resource and check if it is included in the response

Mitigation: A safe solution is to use a Switch/Case statement to determine which file to include.
