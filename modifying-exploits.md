# how to modify exploits - overview

Step 1: Understand what the exploit does

The first step is understanding what the exploit does. That doesn't mean you need to understand the actual inner workings and mechanics of the exploit - although would be nice - but you need to have at least a high-level understanding what the exploit does. In many cases, an exploit tries to executes arbitrary code spawn a cmd window, creates a new administrator account or connects back to your listener, spawning you a remote shell.

If we analyze the MS16-032 exploit closely, we clearly see it's written in Powershell.

At the end of the exploit, we see the following code:

      # LOGON_NETCREDENTIALS_ONLY / CREATE_SUSPENDED
        $CallResult = [Advapi32]::CreateProcessWithLogonW(
            "user", "domain", "pass",
            0x00000002, "C:\Windows\System32\cmd.exe", "",
            0x00000004, $null, $GetCurrentPath,
            [ref]$StartupInfo, [ref]$ProcessInfo)

